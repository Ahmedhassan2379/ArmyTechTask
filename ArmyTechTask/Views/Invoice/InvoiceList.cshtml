
@using ArmyTechTask.BLL.ViewModel.Invoice;
@model ICollection<GetInvoiceViewModel>



<div class="row">
    <div class="col-lg-12">
        <div>
            <table class="table table-striped table-bordered table-responsive">
                <thead>
                    <tr>

                        <th scope="col" style="text-align: center">ID</th>
                        <th scope="col" style="text-align: center">Customer Name</th>
                        <th scope="col" style="text-align: center">Invoice Date</th>
                        <th scope="col" style="text-align: center">Branch Name</th>
                        <th scope="col" style="text-align: center">Cashier Name</th>
                        <th scope="col" style="text-align: center">Invoice Details</th>
                        <th scope="col" style="text-align: center">Total Price</th>
                        <th scope="col"></th>
                    </tr>
                </thead>
                <tbody>

                   

                        @foreach (var item in Model)
                        {

                            <tr>
                                <td >@item.ID</td>
                                <td >@item.CustomerName</td>
                                <td >@item.InvoiceDate.ToString("dd-MM-yyyy hh:mm t")</td>
                                <td >@item.BranchName</td>
                                <td >@item.CashierName</td>


                                <td>
                                    <table class="table table-bordered" style="background-color:cornflowerblue">
                                        <thead>
                                        <tr>
                                            <th>Name</th>
                                            <th>Count</th>
                                            <th>Price</th>
                                            <th>Total</th>
                                            <th></th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        @foreach (var invoiceDetail in item.InvoiceDetails)
                                        {
                                            <tr>
                                                <td>@invoiceDetail.ItemName</td>
                                                <td>@invoiceDetail.ItemCount</td>
                                                <td>@invoiceDetail.ItemPrice</td>
                                                <td>@invoiceDetail.Total</td>
                                                <td>
                                                    @Ajax.ActionLink("Edit", "EditInvoiceItem", "Invoice", new { id = invoiceDetail.ID }, new AjaxOptions { HttpMethod = "GET", InsertionMode = InsertionMode.Replace, UpdateTargetId = "invoice-item-modal-body", OnSuccess = $"toggleInvoiceItemModal('Update Invoice Item #{invoiceDetail.ID}')" }, new { @class = "label label-info" })
                                                    @Ajax.ActionLink("Delete", "DeleteInvoiceItem", "Invoice", new { id = invoiceDetail.ID }, new AjaxOptions { HttpMethod = "DELETE", InsertionMode = InsertionMode.Replace, UpdateTargetId = "invoices-list", OnSuccess = "onDeleteInvoiceItemSuccess()", OnFailure = "onDeleteInvoiceItemFailure()" }, new { @class = "label label-danger" })
                                                </td>
                                            </tr>
                                        }
                                        </tbody>
                                    </table>
                                </td>



                                <td >@item.Total</td>
                                <td class="text-center">
                                    @Ajax.ActionLink("Edit", "Edit", "Invoice", new { id = item.ID }, new AjaxOptions { HttpMethod = "GET", InsertionMode = InsertionMode.Replace, UpdateTargetId = "invoice-modal-body", OnSuccess = $"toggleInvoiceModal('Update Invoice #{item.ID}')" }) |
                                    @Ajax.ActionLink("Delete", "Delete", "Invoice", new { id = item.ID }, new AjaxOptions { HttpMethod = "DELETE", InsertionMode = InsertionMode.Replace, UpdateTargetId = "invoices-list", OnSuccess = "onDeleteInvoiceSuccess()", OnFailure = "onDeleteInvoiceFailure()" })<br /><br />
                                    @Ajax.ActionLink("Add Invoice Item", "CreateInvoiceItem", "Invoice", new { invoiceId = item.ID }, new AjaxOptions { HttpMethod = "GET", InsertionMode = InsertionMode.Replace, UpdateTargetId = "invoice-item-modal-body", OnSuccess = $"toggleInvoiceItemModal('Add New Invoice Item For Invoice #{item.ID}')" })
                                </td>
                            </tr>
                          }
                    
                    </tbody>

                </table>




        </div>
    </div>
</div>
